\mode*

% Since this a solution template for a generic talk, very little can
% be said about how it should be structured. However, the talk length
% of between 15min and 45min and the theme suggest that you stick to
% the following rules:  

% - Exactly two or three sections (other than the summary).
% - At *most* three subsections per section.
% - Talk about 30s to 2min per frame. So there should be between about
%   15 and 30 frames, all told.


\section{The Big Picture}

\begin{frame}
  \begin{center}
    \textbf{Detection}
    \qquad
    \textbf{Prevention}
    \qquad
    Recovery
  \end{center}
\end{frame}

\begin{frame}
  \begin{definition}[Intrusion]
    \begin{itemize}
      \item event or combination of events that constitute a security incident, 
        where an intruder gains, or attempts to gain, access to a resource 
        without authorization.
    \end{itemize}
  \end{definition}

  \begin{definition}[Intrusion detection]
    \begin{itemize}
      \item service that monitors and analyzes system events to detect 
        intrusions.
    \end{itemize}
  \end{definition}
\end{frame}


\section{Intruders}

\begin{frame}
  \includegraphics[width=\columnwidth]{figs/xkcd-341.png}
\end{frame}

\begin{frame}
  \begin{definition}[Intruders]
    \begin{description}
      \item[Masquerader] A user who is not authorized to use the system who 
        penetrates the access control of the system to exploit the user account 
        of a legitimate user.
        (Typically outsider.)

      \item[Misfeasor] A legitimate user who accesses resources for which such 
        access is not authorized, or who misuses his or her privileges.
        (Typically insider.)

      \item[Clandestine user] An individual who seizes supervisory control of 
        the system and uses this control to evade auditing or to suppress audit 
        collection.
    \end{description}
  \end{definition}
\end{frame}

\begin{frame}
  \includegraphics[width=\columnwidth]{figs/xkcd-341.png}
  \begin{example}
    \begin{itemize}
      \item The intruder above is a \emph{masquerader}.
      \item Mrs~Roberts' children are probably \emph{misfeasors}.
    \end{itemize}
  \end{example}
\end{frame}

\subsection{Behaviour Patterns}

\begin{frame}
  \begin{question}
    \begin{itemize}
      \item How does an intruder intrude?
    \end{itemize}
  \end{question}
\end{frame}

\begin{frame}
  \begin{example}[Ways to intrude]
    \begin{itemize}
      \item Phished user credentials
      \item Software bugs in access control
      \item Malware, combination of the previous two.
    \end{itemize}
  \end{example}
\end{frame}

\begin{frame}
  \begin{remark}
    \begin{itemize}
      \item The goal is different from that of ordinary users.
      \item Will this result in a change in behaviour?
    \end{itemize}
  \end{remark}
\end{frame}

\begin{frame}
  \begin{example}[\enquote{Hackers}]
    \begin{itemize}
      \item The \enquote{hacker} will look for targets of opportunities.
    \end{itemize}
  \end{example}

  \begin{definition}
    \begin{description}
      \item[White hat] A benign hacker who is exploratory in nature.
        Notifies targets of findings, bug-bounty hunter.

      \item[Black hat] A malicious hacker who tries to maximize his own gains.
    \end{description}
  \end{definition}
\end{frame}

\begin{frame}
  \begin{figure}
    \includegraphics[width=\columnwidth]{figs/skatteverket-hack.png}
    \caption{\url{https://sverigesradio.se/artikel/5540019}}
  \end{figure}
\end{frame}

\begin{frame}
  \begin{example}[Criminal organizations]
    \begin{itemize}
      \item The criminal organisations will target specific systems of interest.
    \end{itemize}
  \end{example}

  \begin{example}[Randomware]
    \begin{itemize}
      \item Deploy software that encrypts as much vital data as possible.
    \end{itemize}
  \end{example}
\end{frame}

\begin{frame}
  \begin{figure}
    \includegraphics[width=\columnwidth]{figs/ruag-turla.png}
    \caption{\url{https://news.softpedia.com/news/swiss-cert-reveals-two-year-old-cyber-espionage-campaign-against-army-contractor-504385.shtml}}
    %\caption{\url{https://www.melani.admin.ch/dam/melani/en/dokumente/2016/technical\%20report\%20ruag.pdf.download.pdf/Report_Ruag-Espionage-Case.pdf}}
  \end{figure}
\end{frame}

\begin{frame}
  \begin{example}[Insider]
    \begin{itemize}
      \item The insider will just take information available to him or her.
      \item Counter by principle of least privilege, logs, strong 
        authentication, terminate former employees' accounts.
    \end{itemize}
  \end{example}
\end{frame}

\begin{frame}
  \begin{figure}
    \includegraphics[width=\columnwidth]{figs/nsa-leak.png}
    \caption{\url{https://www.bbc.com/news/world-us-canada-48219097}}
  \end{figure}
\end{frame}

\begin{frame}
  \begin{figure}
    \includegraphics[width=\columnwidth]{figs/snowden.png}
    \caption{\url{https://www.theguardian.com/us-news/the-nsa-files}}
  \end{figure}
\end{frame}

%\subsection{Intrusion Techniques}
%
%\begin{frame}
%  \begin{enumerate}
%    \item Try default passwords with standard accounts.
%    \item Exhaustively try all short passwords.
%    \item Try a dictionary attack.
%    \item Collect information about the system users; \eg full names, names of 
%      spouses and children, pictures in their offices.
%    \item Try users' phone numbers, personal ID number, room numbers.
%    \item Try license plate numbers.
%    \item Use a Trojan horse to bypass restrictions on access.
%    \item Tap the connection between a remote user and the host system.
%  \end{enumerate}
%\end{frame}


\section{Intrusion Detection}

\begin{frame}
  \begin{question}
    \begin{itemize}
      \item How can we detect intruders?
    \end{itemize}
  \end{question}
\end{frame}

\begin{frame}
  \begin{idea}
    \begin{itemize}
      \item We can reasonably well distinguish masqueraders through past 
        history.

      \item Misfeasors can be detected by defining what's unauthorised use.

      \item Clandestine user is very difficult to detect automatically.
    \end{itemize}
  \end{idea}
\end{frame}

\begin{frame}
  \begin{remark}
    \begin{itemize}
      \item Intrusion detection is a difficult task.

      \item Based on the assumption that behaviour of intruder and legitimate 
        user can be quantified, and hence differences found.

      \item Problem is these behaviours might sometimes overlap.
    \end{itemize}
  \end{remark}
\end{frame}

\begin{frame}
  \begin{figure}
    \includegraphics[height=0.8\textheight]{figs/behaviour-profiles.pdf}
    \caption{Visualization of overlapping user behavioural profiles.}
  \end{figure}
\end{frame}

\begin{frame}
  \begin{example}[The problematic intersection]
    \begin{itemize}
      \item False positives: authorised users detected as intruders.
      \item False negatives: intruders detected as legitimate users.
    \end{itemize}
  \end{example}

  \pause

  \begin{remark}
    \begin{itemize}
      \item The base-rate fallacy!
    \end{itemize}
  \end{remark}
\end{frame}

\begin{frame}
  \begin{example}[Base-rate fallacy]
    \begin{itemize}
      \item Facial recognition software in airport.
      \item False negatives: if terrorist, alarm goes off 99/100.
      \item False positives: if non-terrorist, alarm goes off 1/100.
    \end{itemize}
  \end{example}

  \begin{exercise}[Base-rate fallacy]
    \begin{itemize}
      \item The alarm goes off, what's the probability that the person 
        scanned is a terrorist?
    \end{itemize}
  \end{exercise}
\end{frame}

\begin{frame}
  \begin{solution}[Base-rate fallacy]
    \begin{itemize}
      \item \(T\) means system indicates terrorist.
      \item We want to find \(\Pr(\terr\mid T)\):
        \only<1>{%
          \begin{align*}
            \Pr(\terr\mid T) &= \frac{\Pr(T\mid \terr) \Pr(\terr)}{\Pr(T)} \\
            \Pr(T\mid \terr) &= \frac{99}{100} \\
            \Pr(T\mid \lnot\terr) &= \frac{1}{100} \\
            \Pr(T) &= \Pr(T\mid \terr)\Pr(\terr) + \\
                   &\qquad\quad \Pr(T\mid \lnot\terr)(1-\Pr(\terr))
          \end{align*}
        }
        \only<2>{%
          \begin{align*}
            \Pr(\terr\mid T) &= \frac{\Pr(T\mid \terr) \Pr(\terr)}{\Pr(T)} \\
                             &= \frac{\frac{99}{100}\Pr(\terr)}{
                               \frac{99}{100}\Pr(\terr) +
                             \frac{1}{100}(1-\Pr(\terr))} \\
                             &= \frac{\frac{99}{100}\Pr(\terr)}{
                               \frac{98}{100}\Pr(\terr) +
                             \frac{1}{100}}
          \end{align*}
        }
    \end{itemize}
  \end{solution}
\end{frame}

\begin{frame}
  \begin{remark}
    \begin{itemize}
      \item How many terrorists are there?
      \item Assume that \(\Pr(\terr) = \frac{1}{1\,000\,000}\)\footnote{%
          30 hijackings per year (1978--2001), \(1.6\cdot 10^{9}\) passengers.
          Assume two terrorists per hijacked flight.
          %https://data.worldbank.org/indicator/IS.AIR.PSGR?end=2001&start=1978
          %https://ourworldindata.org/terrorism#airline-hijackings
        }.

        \pause

      \item That yields \(\Pr(\terr\mid T) \approx \frac{1}{10\,000}\).
      \item The alarm would be correct only \emph{once per 10\,000} alarms!
      \item Crying wolf?
    \end{itemize}
  \end{remark}
\end{frame}


\subsection{What data to use?}

\begin{frame}
  \begin{figure}
    \includegraphics[height=0.70\textheight]{figs/network-rotated.pdf}
    \caption{Example network topology.
      Two remote workers, one hacker and two servers connected over the 
      Internet.
      Three servers, four offices on the internal network.
    }
  \end{figure}
\end{frame}
host-based
network-based

\begin{frame}
  \centering
  \includegraphics[height=0.70\textheight]{figs/network-rotated.pdf}
  \begin{question}
    \begin{itemize}
      \item What data can we get if we place monitoring at the entrance?
    \end{itemize}
  \end{question}
\end{frame}

\begin{frame}
  \begin{figure}
    \includegraphics[height=0.7\textheight]{figs/network-layers.pdf}
    \caption{Communication between Bob and a server.}
  \end{figure}
\end{frame}

\begin{frame}
  \centering
  \includegraphics[height=0.70\textheight]{figs/network-rotated.pdf}
  \begin{question}
    \begin{itemize}
      \item What data can we get if we place monitoring at each server?
    \end{itemize}
  \end{question}
\end{frame}

\begin{frame}
  \centering
  \includegraphics[height=0.70\textheight]{figs/network-rotated.pdf}
  \begin{question}
    \begin{itemize}
      \item What data can we get if we place monitoring at each laptop?
    \end{itemize}
  \end{question}
\end{frame}

\begin{frame}
  \begin{itemize}
    \item Native audit records: log all (relevant) user activity using system 
      logs.

    \item Detection-specific audit records: filters out events interesting for 
      the IDS.

    \item Example: copying a file.

  \end{itemize}
\end{frame}

\subsection{Statistical Anomaly Detection}

\begin{frame}
  \begin{itemize}
    \item Threshold detection: defining thresholds independent of users.

    \item Profile based: use a profile for each user to detect changes in 
      behaviour.

  \end{itemize}
\end{frame}

\subsection{Rule-Based Intrusion Detection}

\begin{frame}
  \begin{itemize}
    \item Rule-based detection: defines rules for attack patterns, also called 
      signature detection.
  \end{itemize}
\end{frame}

%\subsection{The Base-Rule Fallacy}
%
%\begin{frame}
%\end{frame}

\subsection{Distributed Intrusion Detection}

\begin{frame}
  \begin{figure}
    \includegraphics[height=0.7\textheight]{figs/dids.pdf}
    \caption{Distributed Intrusion Detection System.
      Image: \cite{Stallings2013nse}.}
  \end{figure}
\end{frame}

\subsection{Honeypots}

\begin{frame}
  \begin{figure}
    \includegraphics[height=0.7\textheight]{figs/honeypot.pdf}
    \caption{An illustration of honeypots.
      Image: \cite{Stallings2013nse}.}
  \end{figure}
\end{frame}


%\section{Password Management}
%
%\subsection{The Vulnerability of Passwords}
%
%\begin{frame}
%\end{frame}
%
%\subsection{The Use of Hashed Passwords}
%
%\begin{frame}
%\end{frame}
%
%\subsection{User Password Choices}
%
%\begin{frame}
%\end{frame}
%
%\subsection{Password Selection Strategies}
%
%\begin{frame}
%\end{frame}
%
%\subsection{Bloom Filter}
%
%\begin{frame}
%\end{frame}



